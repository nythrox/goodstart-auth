services: 
    - docker

language: node_js
node_js:
    - "13.1.0"
  
os: linux

env: 
  - DB_HOST="ec2-107-22-211-248.compute-1.amazonaws.com" DB_PORT=5432 DB_DATABASE="dber9iuc5redlc" DB_USER='towcipwwtzdydh' DB_PASSWORD='949e0918d36eb9c2a480c7478c02dd4830b8165d011e20f6ab2add8628cfbd92' DB_CONNECTION_URL="postgres://towcipwwtzdydh:949e0918d36eb9c2a480c7478c02dd4830b8165d011e20f6ab2add8628cfbd92@ec2-107-22-211-248.compute-1.amazonaws.com:5432/dber9iuc5redlc?ssl=true" USE_DB_CONNECTION_URL=false PORT=7000 ACCESS_TOKEN_SECRET="jy_YlPs5eB1KV_owTfLT2Dw6_CnQYZmkMh3P425zlRMPtdPSY859RB5N3_Sq_Cq8I-rU0sqbycxwQmgaBS2zI39pZgQxWHwPTtfgkkaKCDpHHWX8vIpSr2bstaoVYSPA_CaM7NNk8JrCIcmJ8V0989yUOy8NevbGVw8s09XYBvQsv9hRhFweTt9q_Ku83uIb--9QqoMuMQ3Dk-WKvS7fVFPBpVyGLOJTClxDpUdCTIsM0Nou9tqHjpyfk5YYokI9Jwb5oeud6bHryDdGUndDe7-Nb_xfPt2NKnk6-tzuOLo4205ekVPvbPcLaOtwBCrLpIeUcAuiFlRknKsgF8J9MQ" ACCESS_TOKEN_EXPIRES_IN="6000000000s" REFRESH_TOKEN_SECRET="9QqoMuMQ3Dk-WKvS7fVFPBpVyGLOJTClxDpUdCTIsM0Nou9tqHjpyfk5YYokI9Jwb5oeud6bHryDdGUndDe7---Nb_xfPt2NKnk6-tzuOLo4205ekVPvbPcLaOtwBCrLpIeUcAuiFlRknKsgF8J9MQjy_YlPs5eB1KV_owTfLT2Dw6_CnQYZmkMh3P425zlRMPtdPSY859RB5N3_Sq_Cq8I-rU0sqbycxwQmgaBS2zI39pZgQxWHwPTtfgkkaKCDpHHWX8vIpSr2bstaoVYSPA_CaM7NNk8JrCIcmJ8V0989yUOy8NevbGVw8s09XYBvQsv9hRhFweTt9q_Ku83uIb" REFRESH_TOKEN_EXPIRES_IN="1y"
  

before_install:
    - docker build -t jasonsb/goodstart-auth:dev -f Dockerfile.dev .

script:
    # - docker run jasonsb/goodstart-auth:dev npm run test -- --coverage
    - docker run --env DB_HOST="ec2-107-22-211-248.compute-1.amazonaws.com" --env DB_PORT=5432 --env DB_DATABASE="dber9iuc5redlc" --env DB_USER='towcipwwtzdydh' --env DB_PASSWORD='949e0918d36eb9c2a480c7478c02dd4830b8165d011e20f6ab2add8628cfbd92' --env DB_CONNECTION_URL="postgres://towcipwwtzdydh:949e0918d36eb9c2a480c7478c02dd4830b8165d011e20f6ab2add8628cfbd92@ec2-107-22-211-248.compute-1.amazonaws.com:5432/dber9iuc5redlc?ssl=true" --env USE_DB_CONNECTION_URL=false --env PORT=7000 --env ACCESS_TOKEN_SECRET="jy_YlPs5eB1KV_owTfLT2Dw6_CnQYZmkMh3P425zlRMPtdPSY859RB5N3_Sq_Cq8I-rU0sqbycxwQmgaBS2zI39pZgQxWHwPTtfgkkaKCDpHHWX8vIpSr2bstaoVYSPA_CaM7NNk8JrCIcmJ8V0989yUOy8NevbGVw8s09XYBvQsv9hRhFweTt9q_Ku83uIb--9QqoMuMQ3Dk-WKvS7fVFPBpVyGLOJTClxDpUdCTIsM0Nou9tqHjpyfk5YYokI9Jwb5oeud6bHryDdGUndDe7-Nb_xfPt2NKnk6-tzuOLo4205ekVPvbPcLaOtwBCrLpIeUcAuiFlRknKsgF8J9MQ" --env ACCESS_TOKEN_EXPIRES_IN="6000000000s" --env REFRESH_TOKEN_SECRET="9QqoMuMQ3Dk-WKvS7fVFPBpVyGLOJTClxDpUdCTIsM0Nou9tqHjpyfk5YYokI9Jwb5oeud6bHryDdGUndDe7---Nb_xfPt2NKnk6-tzuOLo4205ekVPvbPcLaOtwBCrLpIeUcAuiFlRknKsgF8J9MQjy_YlPs5eB1KV_owTfLT2Dw6_CnQYZmkMh3P425zlRMPtdPSY859RB5N3_Sq_Cq8I-rU0sqbycxwQmgaBS2zI39pZgQxWHwPTtfgkkaKCDpHHWX8vIpSr2bstaoVYSPA_CaM7NNk8JrCIcmJ8V0989yUOy8NevbGVw8s09XYBvQsv9hRhFweTt9q_Ku83uIb" --env REFRESH_TOKEN_EXPIRES_IN="1y" jasonsb/goodstart-auth:dev npm run test -- --coverage